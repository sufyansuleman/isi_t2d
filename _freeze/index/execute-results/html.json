{
  "hash": "5baedd0472baa94bd1e645b54e487915",
  "result": {
    "markdown": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n<!-- # Reorder on the IS index  -->\n<!-- t2d_all_indices_bmi$is_index <- factor(t2d_all_indices_bmi$is_index, levels = c(\"1/FIns\", \"1/HOMA-IR\", \"Raynaud SI\", \"QUICKI\", \"Belfiore basal\", \"1/FIns/FGlu\", \"ISI basal\", \"Bennett SI\", \"Avignon SI0\", \"1/Ins 120\", \"1/Glu 120\", \"ISI 120\", \"1/(Ins/Glu)120\", \"Gutt Index\", \"Avignon SI120\", \"Avignon SIM\", \"Stumvoll Modi\", \"Stumvoll Dem\", \"1/IFC\", \"BIGTT SI\", \"Matsuda\")) -->\n\n<!-- # Reorder Index group -->\n<!-- t2d_all_indices_bmi$index_group <- factor(t2d_all_indices_bmi$index_group, levels = c(\"Fasting\", \"OGTT_0,120\", \"OGTT_0,30,120\")) -->\n<!-- ``` -->\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n\n<!-- # Create matrices for the heatmap -->\n\n<!-- # Create a matrix 'snp_index_effect' by selecting 'nearest_gene', 'is_index', and 'alt_effsize' columns -->\n<!-- t2d_effect_matx <- t2d_all_indices_bmi %>% -->\n<!--   dplyr::select(gene_snp_ra, is_index, alt_effsize) %>%  -->\n<!--   tidyr::spread(is_index, alt_effsize) %>%  -->\n<!--       as_tibble() %>%  -->\n<!--   tibble::column_to_rownames(var = \"gene_snp_ra\") %>%  -->\n<!--   as.matrix() -->\n<!-- ``` -->\n\n\n<!-- ```{r} -->\n<!-- # #| echo: false -->\n<!-- # #| include: false -->\n<!-- # #| warning: false -->\n<!-- # #| message: false -->\n<!-- #  -->\n<!-- # # do clustring  -->\n<!-- # set.seed(123) -->\n<!-- # m_clusters <- Mclust(t2d_effect_matx) -->\n<!-- #  -->\n<!-- # # get the cluster classification -->\n<!-- # clusters <- m_clusters$classification -->\n<!-- # # convert to datafrmae -->\n<!-- # data_frame <- as.data.frame(t2d_effect_matx) -->\n<!-- # # add cluster column -->\n<!-- # data_frame$cluster <- clusters -->\n<!-- # # order the rows and then remove the cluster column convert back to matrix -->\n<!-- # t2d_effect_mat_ordered <- data_frame[order(data_frame$cluster), -ncol(data_frame)] %>%  -->\n<!-- #   as.matrix() -->\n\n<!-- ``` -->\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n\n<!-- # Assuming t2d_effect_matx is your data matrix -->\n<!-- # Calculate the distance matrix for rows and columns -->\n<!-- row_dist <- dist(t2d_effect_matx)  # Distance for rows -->\n<!-- col_dist <- dist(t(t2d_effect_matx))  # Distance for columns (transpose the matrix) -->\n\n<!-- # Perform hierarchical clustering -->\n<!-- row_clust <- hclust(row_dist)  # Clustering for rows -->\n<!-- col_clust <- hclust(col_dist)  # Clustering for columns -->\n\n<!-- # Reorder the matrix based on the clustering -->\n<!-- t2d_effect_mat_ordered <- t2d_effect_matx[row_clust$order, col_clust$order] -->\n\n<!-- ``` -->\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n<!-- # Create a matrix 'snp_index_effect' by selecting 'nearest_gene', 'is_index', and 'pvalue' columns -->\n<!-- t2d_p_mat <- t2d_all_indices_bmi %>% -->\n<!--   dplyr::select(gene_snp_ra, is_index, pvalue) %>%  -->\n<!--   tidyr::spread(is_index, pvalue) %>%  -->\n<!--       as_tibble() %>%  -->\n<!--   tibble::column_to_rownames(var = \"gene_snp_ra\") %>%  -->\n<!--   as.matrix() -->\n\n<!-- # ordered the row name sof p_mat to same as the effect_mat -->\n\n<!-- order_names <- rownames(t2d_effect_mat_ordered) -->\n\n<!-- t2d_p_mat_ordred <- t2d_p_mat[order_names, ]  -->\n\n<!-- ``` -->\n\n\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n<!-- # Convert the matrix to a long format -->\n<!-- effsize_long <- as.data.frame(t2d_effect_mat_ordered) %>% -->\n<!--   rownames_to_column(var = \"gene_snp_ra\") %>% -->\n<!--   pivot_longer(cols = -gene_snp_ra, names_to = \"is_index\", values_to = \"alt_effsize\") -->\n\n<!-- p_long <- as.data.frame(t2d_p_mat_ordred) %>% -->\n<!--   rownames_to_column(var = \"gene_snp_ra\") %>% -->\n<!--   pivot_longer(cols = -gene_snp_ra, names_to = \"is_index\", values_to = \"pvalue\") -->\n\n<!-- ``` -->\n\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n<!-- # Combine the data -->\n<!-- combined_data <- effsize_long %>% -->\n<!--   left_join(p_long, by = c(\"gene_snp_ra\", \"is_index\")) %>%  -->\n<!--     mutate( -->\n<!--     index_group = case_when( -->\n<!--       is_index %in% c(\"1/FIns\", \"1/HOMA-IR\", \"Raynaud SI\", \"QUICKI\", \"Belfiore basal\", \"1/FIns/FGlu\", \"ISI basal\", \"Bennett SI\", \"Avignon SI0\") ~ \"Fasting\", -->\n<!--       is_index %in% c(\"1/Ins 120\", \"1/Glu 120\", \"ISI 120\", \"1/(Ins/Glu)120\", \"Gutt Index\", \"Avignon SI120\", \"Avignon SIM\", \"Stumvoll Modi\", \"Stumvoll Dem\", \"1/IFC\") ~ \"OGTT,0-120\", -->\n<!--       is_index %in% c(\"BIGTT SI\", \"Matsuda\") ~ \"OGTT,0-30-120\", -->\n<!--       TRUE ~ \"Other\"  # For any unmatched case -->\n<!--     ) -->\n<!--   ) -->\n\n<!-- ``` -->\n\n\n\n<!-- ```{r} -->\n<!-- # #| echo: false -->\n<!-- # #| include: false -->\n<!-- # #| warning: false -->\n<!-- # #| message: false -->\n<!-- #  -->\n<!-- # combined_data <- combined_data[order(combined_data$alt_effsize, decreasing = TRUE), ] -->\n\n<!-- ``` -->\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| warning: false -->\n<!-- #| message: false -->\n<!-- plotly_heatmap <- plot_ly(data = combined_data, x = ~is_index, y = ~gene_snp_ra, type = \"heatmap\", z = ~alt_effsize, -->\n<!--                           colorscale = list(c(0, \"blue\"), c(0.5, \"white\"), c(1, \"red\")), -->\n<!--                           zmin = -0.04, zmax = 0.04, text = ~paste(gene_snp_ra, -->\n<!--                                                                    \"\\nEffect-size:\", alt_effsize, -->\n<!--                                                                    \"\\nP-value:\", pvalue, -->\n<!--                                                                    \"\\nIndex:\", is_index,  -->\n<!--                                                                    \"\\nIndex Group:\", index_group), -->\n<!--                           hoverinfo = \"text\") %>% -->\n<!--   layout(xaxis = list(title = \"Indices\", tickangle = 90), -->\n<!--          yaxis = list(title = \"Gene SNP RA\"), -->\n<!--          colorbar = list(title = \"Beta\")) -->\n\n\n<!-- ``` -->\n\n\n\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- #| include: false -->\n<!-- #| column: screen -->\n<!-- #| fig.height: 135 -->\n<!-- #| fig-cap: \"Insulin sensitiivty indices assocaition with T2D risk alleles\" -->\n<!-- #| label: Association between 21 insulin sensitivity indices and 426 genetic variants known to be assciated with T2D in population cohort. -->\n\n<!-- plotly_heatmap -->\n\n<!-- ``` -->\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {.cell .column-screen}\n::: {.cell-output-display}\n![Insulin sensitivity indices association with T2D risk alleles](index_files/figure-html/fig-association-t2d-1.png){#fig-association-t2d width=3840}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}